kind: pipeline
type: docker
name: default

trigger:
  ref:
    - refs/heads/drone
    - refs/pull/**
    - refs/tags/**

steps:
  - name: build
    image: registry.digitalocean.com/stewcasa/elm-builder:12
    commands:
      - mkdir /opt/codebase-ui
      - export API_TOKEN=notsecret
      - export API_URL=http://localhost:26116
      - elm make --output=/opt/codebase-ui/index.html src/Main.elm
      - tar -c -z -C /opt codebase-ui casebase-ui-$DRONE_BUILD_NUMBER.tar.gz
